---
title: Traefik + Docker + Vaultwarden
author: devops
date: 2023-05-13 11:00:00 +0300
categories: [–ë–ª–æ–≥, –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏]
tags: [devops –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ docker]
---


# Traefik + Vaultwarden + Docker

–î–æ –∫–∞–∫–æ–≥–æ-—Ç–æ –≤—Ä–µ–º–µ–Ω–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –≤ —Å–≤–æ–∏—Ö –ø—Ä–æ–µ–∫—Ç–∞—Ö NGINX –∫–∞–∫ proxy-—Å–µ—Ä–≤–µ—Ä, –Ω–æ —Ä–µ—à–∏–ª –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å Traefik. –î–∞ –∏ —Å Docker –æ–Ω –±–æ–ª–µ–µ –¥—Ä—É–∂–µ–ª—é–±–µ–Ω, —á–µ–º nginx. –ú–Ω–µ –Ω—É–∂–Ω–æ –±—ã–ª–æ –∑–∞ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è –ø–æ–¥–Ω—è—Ç—å –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ - Traefik + Vaultwarden (–º–æ–∂–µ—Ç –±—ã—Ç—å –ª—é–±–æ–π —Å–µ—Ä–≤–∏—Å).

## –í–≤–µ–¥–µ–Ω–∏–µ
–ü—Ä–∏–≤–µ–¥–µ–Ω–Ω—ã–µ –Ω–∏–∂–µ —Å–ø–∏—Å–∫–∏ –æ–ø–∏—Å—ã–≤–∞—é—Ç —Å—Ä–µ–¥—É –∏ –≤–µ—Ä—Å–∏–∏, –∫–æ—Ç–æ—Ä—ã–µ —è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –¥–ª—è —ç—Ç–æ–≥–æ –ø–æ—Å—Ç–∞, –∏ –≤–æ–∑–º–æ–∂–Ω—ã–µ –¥—Ä—É–≥–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è.

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:

VPS –∏–ª–∏ –¥—Ä—É–≥–æ–π –ª—é–±–æ–π —Å–µ—Ä–≤–µ—Ä —Å Ubuntu(–≤—ã–±–æ—Ä –û–° –Ω–µ –ø—Ä–∏–Ω—Ü–∏–ø–∏–∞–ª–µ–Ω, –≥–ª–∞–≤–Ω–æ–µ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å Docker)
–ü–æ—á—Ç–∏ –ø—Ä—è–º—ã–µ —Ä—É–∫–∏
Traefik
Traefik - —ç—Ç–æ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –∏ –ª–µ–≥–∫–∏–π –æ–±—Ä–∞—Ç–Ω—ã–π –ø—Ä–æ–∫—Å–∏-—Å–µ—Ä–≤–µ—Ä –∏ –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫ –Ω–∞–≥—Ä—É–∑–∫–∏, –∫–æ—Ç–æ—Ä—ã–π —É–ø—Ä–æ—â–∞–µ—Ç —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–æ–≤. –û–Ω —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω —Ç–∞–∫, —á—Ç–æ–±—ã –±—ã—Ç—å –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –ø—Ä–æ—Å—Ç—ã–º –≤ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–∏, –Ω–æ —Å–ø–æ—Å–æ–±–Ω—ã–º –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –±–æ–ª—å—à–∏–µ –∏ –æ—á–µ–Ω—å —Å–ª–æ–∂–Ω—ã–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è.

–û–Ω —Ç–∞–∫–∂–µ –ø–æ—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è —Å –º–æ—â–Ω—ã–º –Ω–∞–±–æ—Ä–æ–º –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω–æ–≥–æ –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–≥–æ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä–æ–µ —Ä–∞—Å—à–∏—Ä—è–µ—Ç –µ–≥–æ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏, –≤–∫–ª—é—á–∞—è –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫—É –Ω–∞–≥—Ä—É–∑–∫–∏, API gateway, –≤—Ö–æ–¥ –≤ orchestrator. –û–Ω –Ω–∞–ø–∏—Å–∞–Ω –Ω–∞ Go –∏ —É–ø–∞–∫–æ–≤–∞–Ω –≤ –≤–∏–¥–µ –æ–¥–Ω–æ–≥–æ –¥–≤–æ–∏—á–Ω–æ–≥–æ —Ñ–∞–π–ª–∞ –∏ –¥–æ—Å—Ç—É–ø–µ–Ω –≤ –≤–∏–¥–µ –∫—Ä–æ—à–µ—á–Ω–æ–≥–æ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–≥–æ –æ–±—Ä–∞–∑–∞ docker.

–¢—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω—ã–µ –æ–±—Ä–∞—Ç–Ω—ã–µ –ø—Ä–æ–∫—Å–∏ —Ç—Ä–µ–±—É—é—Ç, —á—Ç–æ–±—ã –≤—ã –Ω–∞—Å—Ç—Ä–æ–∏–ª–∏ –∫–∞–∂–¥—ã–π –º–∞—Ä—à—Ä—É—Ç, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç —Å–æ–µ–¥–∏–Ω—è—Ç—å –ø—É—Ç–∏ –∏ –ø–æ–¥–¥–æ–º–µ–Ω—ã —Å –∫–∞–∂–¥—ã–º –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–æ–º. –í —Å—Ä–µ–¥–µ, –≥–¥–µ –≤—ã –¥–æ–±–∞–≤–ª—è–µ—Ç–µ, —É–¥–∞–ª—è–µ—Ç–µ, –æ—Ç–∫–ª—é—á–∞–µ—Ç–µ, –æ–±–Ω–æ–≤–ª—è–µ—Ç–µ –∏–ª–∏ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ—Ç–µ —Å–≤–æ–∏ —Å–µ—Ä–≤–∏—Å—ã –º–Ω–æ–≥–æ —Ä–∞–∑ –≤ –¥–µ–Ω—å, –∑–∞–¥–∞—á–∞ –ø–æ–¥–¥–µ—Ä–∂–∞–Ω–∏—è –º–∞—Ä—à—Ä—É—Ç–æ–≤ –≤ –∞–∫—Ç—É–∞–ª—å–Ω–æ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è —É—Ç–æ–º–∏—Ç–µ–ª—å–Ω–æ–π. üòü

Traefik –ø—Ä–æ—Å–ª—É—à–∏–≤–∞–µ—Ç –≤–∞—à —Å–µ—Ä–≤–∏—Å registry / orchestrator API –∏ –º–≥–Ω–æ–≤–µ–Ω–Ω–æ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –º–∞—Ä—à—Ä—É—Ç—ã, —á—Ç–æ–±—ã –≤–∞—à–∏ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å—ã –±—ã–ª–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω—ã –∫ –≤–Ω–µ—à–Ω–µ–º—É –º–∏—Ä—É ‚Äî –±–µ–∑ –¥–∞–ª—å–Ω–µ–π—à–µ–≥–æ –≤–º–µ—à–∞—Ç–µ–ª—å—Å—Ç–≤–∞ —Å –≤–∞—à–µ–π —Å—Ç–æ—Ä–æ–Ω—ã.


## –ù–∞—Å—Ç—Ä–æ–π–∫–∏
–Ø –ø—Ä–æ–ø—É—â—é –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏, —Ç–∞–∫–∏–µ –∫–∞–∫ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ DNS –∑–∞–ø–∏—Å–µ–π, –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–æ–º–µ–Ω–æ–≤.

–Ø –∑–∞—Ä–∞–Ω–µ–µ –ø–æ–¥–≥–æ—Ç–æ–≤–∏–ª —Å—Ç—Ä—É–∫—Ç—É—Ä—É, –∫–æ—Ç–æ—Ä–∞—è —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∞ –≤ –º–æ–µ–º Github.

```
git clone git@github.com:devopsinka/docker-traefik-vaultwarden.git ./src
```

```
.
‚îî‚îÄ‚îÄ src/
    ‚îú‚îÄ‚îÄ core/
    ‚îÇ   ‚îú‚îÄ‚îÄ traefik-data/
    ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ configurations/
    ‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ dynamic.yml
    ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ traefik.yml
    ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ acme.json
    ‚îÇ   ‚îî‚îÄ‚îÄ docker-compose.yml
    ‚îî‚îÄ‚îÄ apps/
```
–ù–µ–º–Ω–æ–≥–æ —Ç–µ–æ—Ä–∏–∏.

traefik.yml –ü–µ—Ä–≤—ã–π —Ñ–∞–π–ª, –∫–æ—Ç–æ—Ä—ã–π –º—ã —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º, - —ç—Ç–æ traefik.yml —Ñ–∞–π–ª, –∫–∞–∫ –ø–æ–∫–∞–∑–∞–Ω–æ –≤–æ —Ñ—Ä–∞–≥–º–µ–Ω—Ç–µ –∫–æ–¥–∞ –Ω–∏–∂–µ. –≠—Ç–æ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∞—è –±–∞–∑–æ–≤–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Traefik.

–°–Ω–∞—á–∞–ª–∞ –º—ã —Å–æ–æ–±—â–∞–µ–º Traefik –≤ —Å—Ç—Ä–æ–∫–µ 2, —á—Ç–æ –Ω–∞–º –Ω—É–∂–µ–Ω –≤–µ–±-–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å, —É—Å—Ç–∞–Ω–æ–≤–∏–≤ dashboard:true

–ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ –º—ã –æ–ø—Ä–µ–¥–µ–ª—è–µ–º –Ω–∞—à–∏ –¥–≤–µ —Ç–æ—á–∫–∏ –≤—Ö–æ–¥–∞ web (http) –∏ websecure (https). –î–ª—è –Ω–∞—à–µ–π –∑–∞—â–∏—â–µ–Ω–Ω–æ–π https –∫–æ–Ω–µ—á–Ω–æ–π —Ç–æ—á–∫–∏ –º—ã –Ω–∞—Å—Ç—Ä–æ–∏–ª–∏ certResolver, —á—Ç–æ–±—ã –º—ã –º–æ–≥–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º–∏ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞–º–∏ –æ—Ç Let‚Äôs Encrypt! üòÑ –î–∞–ª–µ–µ –≤ —Å—Ç—Ä–æ–∫–µ 16 –º—ã –∑–∞–≥—Ä—É–∂–∞–µ–º —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–µ –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω–æ–µ –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–µ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏–µ, —á—Ç–æ–±—ã –≤–µ—Å—å –Ω–∞—à —Ç—Ä–∞—Ñ–∏–∫ –±—ã–ª –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω –Ω–∞ https.

–í providers —á–∞—Å—Ç–∏ –≤ —Å—Ç—Ä–æ–∫–µ 20 –º—ã —É–∫–∞–∑—ã–≤–∞–µ–º, —á—Ç–æ —ç—Ç–æ—Ç —Ñ–∞–π–ª –±—É–¥–µ—Ç –ø–µ—Ä–µ–¥–∞–Ω –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä docker —Å –ø–æ–º–æ—â—å—é bind mount. –ú—ã —Ç–∞–∫–∂–µ –ø—Ä–æ—Å–∏–º Traefik –Ω–∞–π—Ç–∏ –Ω–∞—à—É –¥–∏–Ω–∞–º–∏—á–µ—Å–∫—É—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –≤ configurations/dynamic.yml. –ò, –Ω–∞–∫–æ–Ω–µ—Ü, –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–ª—è –Ω–∞—à–µ–≥–æ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—è SSL-—Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤.


```
api:
  dashboard: true

entryPoints:
  web:
    address: ":80"
    http:
      redirections:
        entryPoint:
          to: websecure

  websecure:
    address: ":443"
    http:
      middlewares:
        - secureHeaders@file
      tls:
        certResolver: letsencrypt

providers:
  docker:
    endpoint: "unix:///var/run/docker.sock"
    exposedByDefault: false
  file:
    filename: /configurations/dynamic.yml

certificatesResolvers:
  letsencrypt:
    acme:
      email: admin@yourdomain.com
      storage: acme.json
      keyType: EC384
      httpChallenge:
        entryPoint: web
```

–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ: –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω—É—é –ø–æ—á—Ç—É –≤ —ç—Ç–æ–º —Ñ–∞–π–ª–µ –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è Let‚Äôs Encrypt. @yourdomain.com –º–æ–∂–µ—Ç –≤–æ–∑–Ω–∏–∫–Ω—É—Ç—å –æ—à–∏–±–∫–∞, –∫–æ–≥–¥–∞ –≤—ã –∑–∞—Ö–æ—Ç–∏—Ç–µ –∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–≤–æ–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä docker!

dynamic.yml –≠—Ç–æ—Ç —Ñ–∞–π–ª —Å–æ–¥–µ—Ä–∂–∏—Ç –Ω–∞—à–µ –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω–æ–µ –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–µ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏–µ, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—â–µ–µ –ø–æ–ª–Ω—É—é –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –≤—Å–µ–≥–æ –Ω–∞—à–µ–≥–æ —Ç—Ä–∞—Ñ–∏–∫–∞ –∏ –ø—Ä–æ—Ö–æ–¥—è—â–µ–µ –ø–æ –ø—Ä–æ—Ç–æ–∫–æ–ª—É TLS. –ú—ã —Ç–∞–∫–∂–µ –Ω–∞—Å—Ç—Ä–æ–∏–ª–∏ –±–∞–∑–æ–≤—É—é –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é –∑–¥–µ—Å—å –≤ —Å—Ç—Ä–æ–∫–∞—Ö 11-14 –¥–ª—è –Ω–∞—à–µ–π –ø–∞–Ω–µ–ª–∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ Traefik, –ø–æ—Ç–æ–º—É —á—Ç–æ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –æ–Ω–∞ –¥–æ—Å—Ç—É–ø–Ω–∞ –¥–ª—è –≤—Å–µ—Ö.

–§–∞–π–ª –ø–æ–ª–Ω–æ—Å—Ç—å—é –¥–∏–Ω–∞–º–∏—á–µ–Ω –∏ –º–æ–∂–µ—Ç –±—ã—Ç—å –æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω ‚Äú–Ω–∞ –ª–µ—Ç—É‚Äù, –±–µ–∑ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ –Ω–∞—à–µ–≥–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞.

```
# Dynamic configuration
http:
  middlewares:
    secureHeaders:
      headers:
        sslRedirect: true
        forceSTSHeader: true
        stsIncludeSubdomains: true
        stsPreload: true
        stsSeconds: 31536000
    user-auth:
      basicAuth:
        users:
          - "raf:$apr1$MTqfVwiE$FKkzT5ERGFqwH9f3uipxA1"

tls:
  options:
    default:
      cipherSuites:
        - TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384
        - TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384
        - TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256
        - TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256
        - TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305
        - TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305
      minVersion: VersionTLS12
```
–ö–∞–∫ –º–æ–∂–Ω–æ —É–≤–∏–¥–µ—Ç—å –∏–∑ –∫–æ–¥–∞ –≤—ã—à–µ, —É –Ω–∞—Å –µ—Å—Ç—å –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω–∞—è —Å—Ç—Ä–æ–∫–∞. –≠—Ç–æ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω–∞—è —Å—Ç—Ä–æ–∫–∞, –∫–æ—Ç–æ—Ä–∞—è —Å–æ–¥–µ—Ä–∂–∏—Ç –≤ —Å–µ–±–µ username –∏ –ø–∞—Ä–æ–ª—å –æ—Ç dashboard traefik. –î–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –ª–æ–≥–∏–Ω –∏ –ø–∞—Ä–æ–ª—å. –ù–µ–æ–±—Ö–æ–¥–∏–º–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤ —Å–∏—Å—Ç–µ–º—É –ø–∞–∫–µ—Ç

sudo apt install apache2-utils

–ò –ø–æ—Å–ª–µ —ç—Ç–æ–≥–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å:

echo $(htpasswd -nb <username> <password>)

–ü–æ–ª—É—á–µ–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –≤—Å—Ç–∞–≤–∏—Ç—å –≤ basicAuth

docker-compose.yml –°–∞–º—ã–π –≤–∞–∂–Ω—ã–π —Ñ–∞–π–ª. –ò–º–µ–Ω–Ω–æ –∑–¥–µ—Å—å –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤—Å—è –º–∞–≥–∏—è. –ü—Ä–µ–ª–µ—Å—Ç—å Traefik –≤ —Ç–æ–º, —á—Ç–æ –ø–æ—Å–ª–µ –ø–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –æ—á–µ–Ω—å –ø—Ä–æ—Å—Ç—ã–º. –≠—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—É—Ç–µ–º —É–∫–∞–∑–∞–Ω–∏—è labels –¥–ª—è –≤–∞—à–∏—Ö –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤.

```
version: "3.8"

services:
  traefik:
    image: "traefik:latest"
    container_name: traefik
    restart: unless-stopped
    security_opt:
      - "no-new-privileges:true"
    networks:
      - proxy
    ports:
      - "80:80"
      - "443:443"
    volumes:
      - "/etc/localtime:/etc/localtime:ro"
      - "/var/run/docker.sock:/var/run/docker.sock:ro"
      - "./traefik-data/traefik.yml:/traefik.yml:ro"
      - "./traefik-data/acme.json:/acme.json"
      - "./traefik-data/configurations:/configurations"
    labels:
      - traefik.enable=true
      - traefik.docker.network=proxy
      - traefik.http.routers.traefik-secure.entrypoints=websecure
      - traefik.http.routers.traefik-secure.rule=Host(`traefik.example.com`)
      - traefik.http.routers.traefik-secure.service=api@internal
      - traefik.http.routers.traefik-secure.middlewares=user-auth@file


  vaultwarden:
    image: vaultwarden/server:latest
    container_name: vaultwarden
    restart: always
    environment:
      - WEBSOCKET_ENABLED=true
      - SIGNUPS_ALLOWED=false
    volumes:
      - ./vw-data:/data
    labels:
      - traefik.enable=true
      - traefik.docker.network=proxy
      - traefik.http.routers.fastapi.entrypoints=websecure
      - traefik.http.routers.fastapi.rule=Host(`vault.example.com`)
    networks:
      - proxy

networks:
  proxy:
    external: true
```

–î–ª—è –∫–∞–∂–¥–æ–≥–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞, –∫–æ—Ç–æ—Ä—ã–π –≤—ã —Ö–æ—Ç–∏—Ç–µ, —á—Ç–æ–±—ã Traefik –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–ª, –≤—ã –¥–æ–±–∞–≤–ª—è–µ—Ç–µ –º–µ—Ç–∫–∏, —á—Ç–æ–±—ã Traefik –∑–Ω–∞–ª, –∫—É–¥–∞ –µ–≥–æ —Å–ª–µ–¥—É–µ—Ç –Ω–∞–ø—Ä–∞–≤–∏—Ç—å. –ò—Ç–∞–∫, –∫–æ–≥–¥–∞ –º—ã –ø–æ—Å–º–æ—Ç—Ä–∏–º –Ω–∞ —Ñ–∞–π–ª –≤—ã—à–µ, –¥–∞–≤–∞–π—Ç–µ –±—ã—Å—Ç—Ä–æ –ø—Ä–æ–≤–µ—Ä–∏–º, —á—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤ traefik –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ.

–ò—Ç–∞–∫, –º—ã –ø—Ä–∏–∫—Ä–µ–ø–ª—è–µ–º –ø–µ—Ä–≤—É—é –º–µ—Ç–∫—É –≤ —Å—Ç—Ä–æ–∫–µ 22, –∫–æ—Ç–æ—Ä–∞—è —Å–æ–æ–±—â–∞–µ—Ç Traefik, —á—Ç–æ –æ–Ω –¥–æ–ª–∂–µ–Ω –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–∏—Ç—å —ç—Ç–æ—Ç –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä, –ø–æ—Ç–æ–º—É —á—Ç–æ –º—ã —É–∫–∞–∑—ã–≤–∞–µ–º enable=true. –≠—Ç–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–æ–º traefik.yml —Ñ–∞–π–ª–µ, –≥–¥–µ –º—ã —è–≤–Ω–æ —É–∫–∞–∑–∞–ª–∏ exposedByDefault: false, –ø–æ—ç—Ç–æ–º—É –º—ã –¥–æ–ª–∂–Ω—ã —É–∫–∞–∑–∞—Ç—å —ç—Ç–æ.

–í—Ç–æ—Ä–∞—è –º–µ—Ç–∫–∞ –≤ —Å—Ç—Ä–æ–∫–µ 23 —Å–æ–æ–±—â–∞–µ—Ç –Ω–∞–º, —á—Ç–æ –º—ã –¥–æ–ª–∂–Ω—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–µ—Ç—å proxy, –∫–æ—Ç–æ—Ä—É—é –º—ã —Å–æ–∑–¥–∞–¥–∏–º –ø–æ–∑–∂–µ. –ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ –º—ã –≥–æ–≤–æ—Ä–∏–º Traefik –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–∞—à—É websecure –∫–æ–Ω–µ—á–Ω—É—é —Ç–æ—á–∫—É (https). –ó–∞—Ç–µ–º –º—ã —É–∫–∞–∑—ã–≤–∞–µ–º –∏–º—è –Ω–∞—à–µ–≥–æ —Ö–æ—Å—Ç–∞ —Å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–º –¥–æ–º–µ–Ω–æ–º –≤ —Å—Ç—Ä–æ–∫–µ 25. üëç

–ú–µ—Ç–∫–∞ –æ—Ç –ø–æ—Å–ª–µ–¥–Ω–µ–π –¥–æ –ø–æ—Å–ª–µ–¥–Ω–µ–π —É–∫–∞–∑—ã–≤–∞–µ—Ç –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ API. –û–Ω–æ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Ç–∞–∫—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é, –∫–∞–∫ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –≤—Å–µ—Ö –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä–æ–≤, —Å–ª—É–∂–±, –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω–æ–≥–æ –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–≥–æ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è –∏ —Ç.–¥. –ß—Ç–æ–±—ã –ø—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≤—Å–µ –¥–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–Ω–µ—á–Ω—ã–µ —Ç–æ—á–∫–∏, –≤—ã –º–æ–∂–µ—Ç–µ –æ–∑–Ω–∞–∫–æ–º–∏—Ç—å—Å—è —Å –¥–æ–∫—É–º–µ–Ω—Ç–∞–º–∏.

–°–∞–º–∞—è –ø–æ—Å–ª–µ–¥–Ω—è—è –º–µ—Ç–∫–∞ –≤ —Å—Ç—Ä–æ–∫–µ 27 - —ç—Ç–æ –Ω–∞—à–µ –±–∞–∑–æ–≤–æ–µ –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω–æ–µ –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–µ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏–µ –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏, –ø–æ–º–Ω–∏—Ç–µ? –ü–æ—Å–∫–æ–ª—å–∫—É –ø–∞–Ω–µ–ª—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ Traefik –¥–æ—Å—Ç—É–ø–Ω–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é, –º—ã –¥–æ–±–∞–≤–ª—è–µ–º –∫ –Ω–µ–π –±–∞–∑–æ–≤—ã–π —É—Ä–æ–≤–µ–Ω—å –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏. –≠—Ç–æ —Ç–∞–∫–∂–µ –∑–∞—â–∏—Ç–∏—Ç –Ω–∞—à API.

–°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ–∫—Å–∏-—Å–µ—Ç–∏

–ù–∞–º –Ω—É–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é —Å–µ—Ç—å Docker, –∫–æ—Ç–æ—Ä–∞—è –±—É–¥–µ—Ç –ø—Ä–æ–ø—É—Å–∫–∞—Ç—å –≤–Ω–µ—à–Ω–∏–π —Ç—Ä–∞—Ñ–∏–∫. –≠—Ç–æ –¥–æ–ª–∂–Ω–æ –≤—ã–∑—ã–≤–∞—Ç—å—Å—è proxy —Ç–∞–∫, –∫–∞–∫ –º—ã —É–∫–∞–∑–∞–ª–∏ –≤ –Ω–∞—à–µ–º docker-compose.yml —Ñ–∞–π–ª–µ:

```
networks:
  - proxy
```

–ß—Ç–æ–±—ã —Å–æ–∑–¥–∞—Ç—å —Å–µ—Ç—å docker, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ:

```
sudo docker network create proxy
```


–ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –Ω–∞–¥–ª–µ–∂–∞—â–∏—Ö —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π –¥–ª—è acme.json –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –¥–ª—è —Ñ–∞–π–ª–∞ acme.json —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ 644, —ç—Ç–æ –ø—Ä–∏–≤–µ–¥–µ—Ç –∫ –æ—à–∏–±–∫–µ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ docker-compose. –ü–æ—ç—Ç–æ–º—É —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—ã —É—Å—Ç–∞–Ω–æ–≤–∏–ª–∏ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –¥–ª—è —ç—Ç–æ–≥–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Ñ–∞–π–ª–∞ –Ω–∞ 600. cd –≤–æ–π–¥–∏—Ç–µ –≤ core –ø–∞–ø–∫—É –∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–ª–µ–¥—É—é—â—É—é –∫–æ–º–∞–Ω–¥—É:

```
sudo chmod 600 ./traefik-data/acme.json
```


–ó–∞–ø—É—Å–∫ —Å—Ç–µ–∫–∞ –¢–µ–ø–µ—Ä—å –ø—Ä–∏—à–ª–æ –≤—Ä–µ–º—è –∑–∞–ø—É—Å—Ç–∏—Ç—å —Å—Ç–µ–∫. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—ã –Ω–∞—Ö–æ–¥–∏—Ç–µ—Å—å –≤ core –ø–∞–ø–∫–µ, —á—Ç–æ–±—ã docker –º–æ–≥ –Ω–∞–π—Ç–∏ —Ñ–∞–π–ª docker-compose. –ü—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ –º–Ω–µ –≤—Å–µ–≥–¥–∞ –Ω—Ä–∞–≤–∏—Ç—Å—è –ø—Ä–æ–≤–µ—Ä—è—Ç—å –ø—Ä–æ—Ü–µ—Å—Å –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –æ—à–∏–±–æ–∫, –ø—Ä–µ–∂–¥–µ —á–µ–º –º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º —Ñ–ª–∞–≥ docker compose ‚Äìdetach. –í—ã–ø–æ–ª–Ω–∏—Ç–µ —Å–ª–µ–¥—É—é—â—É—é –∫–æ–º–∞–Ω–¥—É:

sudo docker compose down && sudo docker compose up -d
DONE!